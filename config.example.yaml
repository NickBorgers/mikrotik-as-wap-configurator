# MikroTik Network Configuration Example
#
# This file supports three modes:
#   - standalone (default): Independent WiFi AP
#   - controller: CAPsMAN controller managing CAP devices
#   - cap: Controlled Access Point receiving config from controller
#
# For multi-device CAPsMAN deployments, see multiple-devices.example.yaml

device:
  host: 192.168.88.1
  username: admin
  password: admin

# Role determines device mode (default: standalone)
# role: standalone  # Independent WiFi AP (default)
# role: controller  # CAPsMAN controller
# role: cap         # Controlled Access Point

# Management interfaces
# Typically ether1 is used as trunk port (untagged management + tagged VLANs)
managementInterfaces:
  - ether1

# Unused interfaces to disable for security
# If you use ether2, remove it from this list and add to managementInterfaces
disabledInterfaces:
  - ether2

# IGMP Snooping (Optional)
# Enable IGMP snooping on the bridge to optimize multicast traffic (e.g., Sonos, Chromecast)
# When enabled, multicast traffic is only forwarded to ports with interested receivers
# Default: false (disabled) - MikroTik default behavior
# igmpSnooping: true

# WiFi Optimization Settings (Optional)
# Configure channel, power, and roaming settings for optimal performance
# Especially useful when multiple APs are deployed in close proximity
wifi:
  country: United States    # Regulatory domain (applies to all bands)

  # 2.4GHz band settings
  2.4GHz:
    channel: 1              # Channel number (1-13, use 1/6/11 for non-overlapping)
    # frequency: 2412       # Or specify frequency in MHz directly
    txPower: 15             # TX power in dBm (adjust based on coverage needs)
    width: 20mhz            # Channel width (20mhz recommended for 2.4GHz to avoid interference)

  # 5GHz band settings
  5GHz:
    channel: 36             # Channel number (36/52/149 recommended for non-overlapping)
    # frequency: 5180       # Or specify frequency in MHz directly
    txPower: 18             # TX power in dBm
    width: 20/40/80mhz      # Channel width (20/40/80mhz for better throughput, or 20/40/80/160mhz if supported)

# SSID Configuration
# Each SSID can be broadcast on 2.4GHz, 5GHz, or both bands
#
# Fast Roaming (802.11r/k/v) - configured per-SSID:
#   fastTransition: true   - 802.11r Fast BSS Transition (reduces handoff time)
#   rrm: true              - 802.11k Radio Resource Management (neighbor reports)
#   wnm: true              - 802.11v Wireless Network Management (client steering)
#   transitionThreshold: -80  - Signal threshold (dBm) for 802.11v steering
#
# Note: 802.11k/v require CAPsMAN mode (role: controller) for full coordination.
# In standalone mode, only 802.11r provides roaming benefit.
#
# Recommendation:
#   - Enable for mobile devices (laptops, phones) that move between APs
#   - Disable for stationary devices (Sonos, IoT) that may have 802.11r issues
#
ssids:
  # Primary network with full roaming support for mobile devices
  - ssid: MyNetwork
    passphrase: secure-password-here
    vlan: 100
    bands:
      - 2.4GHz
      - 5GHz
    roaming:
      fastTransition: true  # 802.11r - fast BSS transition
      rrm: true             # 802.11k - neighbor reports (CAPsMAN only)
      wnm: true             # 802.11v - client steering (CAPsMAN only)
      transitionThreshold: -80  # Signal threshold for 802.11v steering

  # 5GHz only network with roaming (high-performance devices)
  - ssid: MyNetwork-5G
    passphrase: secure-password-here
    vlan: 100
    bands:
      - 5GHz
    roaming:
      fastTransition: true  # 802.11r enabled

  # IoT/Sonos network - 802.11r DISABLED for stationary devices
  # Many IoT devices and Sonos speakers have issues with 802.11r
  - ssid: IoT-Devices
    passphrase: iot-password
    vlan: 100
    bands:
      - 2.4GHz
    # No roaming config = 802.11r disabled (recommended for stationary devices)

  # Guest network - 802.11r disabled for simplicity
  # Guest devices may have varying 802.11r support
  - ssid: Guest-WiFi
    passphrase: guest-password
    vlan: 200
    bands:
      - 2.4GHz
      - 5GHz
    # No roaming config = 802.11r disabled

# Supported bands: 2.4GHz, 5GHz
# Supported VLANs: Any VLAN ID (100, 200, etc.)

# ============================================================================
# CAPsMAN Controller Configuration (role: controller)
# ============================================================================
# Uncomment and configure for CAPsMAN controller mode:
#
# capsman:
#   certificate: auto              # Auto-generate certificate (recommended)
#   requirePeerCertificate: false  # Require CAPs to have certificates
#
# The controller creates "master configurations" from SSIDs above and
# provisions CAPs that connect to it.

# ============================================================================
# CAP (Controlled Access Point) Configuration (role: cap)
# ============================================================================
# Uncomment and configure for CAP mode:
#
# cap:
#   controllerAddresses:           # Controller IP address(es) - FQDNs resolved automatically
#     - 192.168.88.1
#
# CAP devices receive WiFi configuration from the controller.
# Local wifi settings (channel, txPower) override controller defaults.
# SSIDs are NOT needed in CAP config - they come from the controller.
#
# Note: RouterOS wifi-qcom requires IP addresses for caps-man-addresses.
# FQDNs are resolved to IPs automatically before configuration.
