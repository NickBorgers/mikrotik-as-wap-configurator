# MikroTik Multi-Device Configuration Example
#
# Workflow:
#   1. Create this file with just device credentials
#   2. Run: ./backup-multiple-devices.js multiple-devices.yaml
#   3. Edit the generated configs (replace UNKNOWN passphrases if any)
#   4. Run: ./apply-multiple-devices.js multiple-devices.yaml
#
# For multiple physically close devices:
#   - Use non-overlapping channels (2.4GHz: 1/6/11, 5GHz: 36/52/149)
#   - Use ./diag/optimize-wifi-channels.js to analyze and suggest optimal channels
#
# 802.11r Fast Roaming (per-SSID):
#   - Enable for mobile devices: roaming: { fastTransition: true }
#   - Disable for stationary devices (Sonos, IoT): omit roaming config
#   - Each SSID can have different roaming settings

# Regulatory domain - applies to all devices in the deployment
country: United States

# Remote syslog configuration - applies to all devices
# Useful for centralized logging of WiFi client connect/disconnect events
# to track client roaming between APs
syslog:
  server: 10.0.0.100      # Syslog server IP (e.g., Gravwell, Elasticsearch, rsyslog)
  port: 514               # Syslog port (default: 514)
  topics:                 # Log topics to send
    - wireless            # WiFi client connect/disconnect events

devices:
  # First Access Point
  - device:
      host: 192.168.88.1
      username: admin
      password: admin
    managementInterfaces:
      - ether1
    disabledInterfaces:
      - ether2
    # WiFi optimization for first AP
    wifi:
      2.4GHz:
        channel: 1        # Non-overlapping channel 1
        txPower: 15       # Adjust based on coverage area
        width: 20mhz      # 20MHz only to avoid interference
      5GHz:
        channel: 36       # Non-overlapping channel 36
        txPower: 18
        width: 20/40/80mhz  # Wider channels for better throughput
    ssids:
      # Primary network with 802.11r for seamless roaming
      - ssid: MyNetwork
        passphrase: secure-password-here
        vlan: 100
        bands:
          - 2.4GHz
          - 5GHz
        roaming:
          fastTransition: true  # 802.11r enabled

      # IoT devices - no 802.11r (stationary devices)
      - ssid: IoT-Devices
        passphrase: iot-password-here
        vlan: 100
        bands:
          - 2.4GHz
        # No roaming config = 802.11r disabled

      # Guest network without roaming
      - ssid: Guest-WiFi
        passphrase: guest-password-here
        vlan: 200
        bands:
          - 2.4GHz
          - 5GHz

  # Second Access Point (same SSIDs, different channels)
  - device:
      host: 192.168.88.2
      username: admin
      password: admin
    managementInterfaces:
      - ether1
    disabledInterfaces:
      - ether2
    # WiFi optimization for second AP - non-overlapping with first AP
    wifi:
      2.4GHz:
        channel: 6        # Non-overlapping channel 6
        txPower: 15
        width: 20mhz      # 20MHz only to avoid interference
      5GHz:
        channel: 52       # Non-overlapping channel 52
        txPower: 18
        width: 20/40/80mhz  # Wider channels for better throughput
    ssids:
      - ssid: MyNetwork
        passphrase: secure-password-here
        vlan: 100
        bands:
          - 2.4GHz
          - 5GHz
        roaming:
          fastTransition: true

      - ssid: IoT-Devices
        passphrase: iot-password-here
        vlan: 100
        bands:
          - 2.4GHz

      - ssid: Guest-WiFi
        passphrase: guest-password-here
        vlan: 200
        bands:
          - 2.4GHz
          - 5GHz

  # Third Access Point (different SSIDs, third channel set)
  - device:
      host: 192.168.88.3
      username: admin
      password: admin
    managementInterfaces:
      - ether1
      - ether2  # This AP uses both ports
    disabledInterfaces: []  # No disabled interfaces
    # WiFi optimization for third AP - completes non-overlapping set
    wifi:
      2.4GHz:
        channel: 11       # Non-overlapping channel 11
        txPower: 15
        width: 20mhz      # 20MHz only to avoid interference
      5GHz:
        channel: 149      # Non-overlapping channel 149
        txPower: 18
        width: 20/40/80mhz  # Wider channels for better throughput
    ssids:
      # 5GHz only for high-performance devices
      - ssid: MyNetwork-5G
        passphrase: secure-password-here
        vlan: 100
        bands:
          - 5GHz
        roaming:
          fastTransition: true

      # Corporate network
      - ssid: Corporate
        passphrase: corporate-password
        vlan: 50
        bands:
          - 2.4GHz
          - 5GHz
        roaming:
          fastTransition: true

  # Fourth Access Point (LACP bonded uplink for redundancy)
  # Requires switch support for LACP (802.3ad)
  - device:
      host: 192.168.88.4
      username: admin
      password: admin
    managementInterfaces:
      # LACP bond configuration - combines ether1+ether2 for redundancy
      # IMPORTANT: First interface in the list is used as "primary" for consistent MAC address
      # This ensures DHCP static leases work reliably across reboots
      - bond:
          - ether1    # Primary - bond will use this interface's MAC address
          - ether2
    disabledInterfaces: []
    wifi:
      2.4GHz:
        channel: 1
        txPower: 15
        width: 20mhz
      5GHz:
        channel: 36
        txPower: 18
        width: 20/40/80mhz
    ssids:
      - ssid: MyNetwork
        passphrase: secure-password-here
        vlan: 100
        bands:
          - 2.4GHz
          - 5GHz
        roaming:
          fastTransition: true
